# STEP NEXT-5 — UI 프로토타입 실행 가이드

**목적**: Response View Model (JSON) → ChatGPT 스타일 화면 렌더링 검증
**작성일**: 2025-12-28
**구현 방식**: Fixture 기반 순수 HTML/JS (No Backend, No LLM)

---

## 1. 개요

### 1.1 프로토타입 목적

- ✅ STEP NEXT-2/3/4에서 합의한 Response View Model이 실제 화면에 정확히 렌더링되는지 검증
- ✅ 예제 1~4 모두 화면에서 즉시 확인 가능
- ✅ Evidence Viewer, 접기/펼치기, 확인 불가 처리 등 UI 인터랙션 동작 확인
- ❌ 실제 LLM 호출, DB 조회, API 연결 없음 (순수 렌더링 검증)

### 1.2 기술 스택

- 순수 HTML + CSS + JavaScript (No Framework)
- Fixture: JSON 파일 4개 (예제 1~4)
- 로컬 브라우저에서 직접 실행 가능 (No Server Required)

---

## 2. 로컬 실행 방법

### 2.1 파일 구조

```
inca-rag-scope/
└── apps/
    └── web-prototype/
        ├── index.html              (메인 HTML 파일)
        └── fixtures/
            ├── example1_premium.json
            ├── example2_coverage_compare.json
            ├── example3_product_summary.json
            └── example4_ox.json
```

### 2.2 실행 방법 (3가지 옵션)

#### 옵션 1: 브라우저에서 직접 열기 (권장)

```bash
# 프로젝트 루트에서
cd apps/web-prototype
open index.html  # macOS
# 또는
start index.html  # Windows
# 또는
xdg-open index.html  # Linux
```

#### 옵션 2: Python 간이 서버

```bash
cd apps/web-prototype
python3 -m http.server 8000

# 브라우저에서 http://localhost:8000 접속
```

#### 옵션 3: VS Code Live Server

1. VS Code에서 `apps/web-prototype/index.html` 열기
2. 우클릭 → "Open with Live Server"

---

## 3. 예제 전환 방법

### 3.1 첫 화면

브라우저에서 `index.html`을 열면:

```
┌─────────────────────────────────────────────┐
│ 💬 보험 상품 비교 도우미                    │
│ Response View Model 렌더링 프로토타입       │
└─────────────────────────────────────────────┘

┌─────────────────────────────────────────────┐
│ 시스템 안내                                  │
│ (접기/펼치기 가능)                           │
└─────────────────────────────────────────────┘

┌─────────────────────────────────────────────┐
│ 📌 예제 선택                                 │
│                                              │
│ [예제 1: 보험료 비교 (보험료 경고)]         │
│ [예제 2: 담보 조건 비교 (5개 조건)]         │
│ [예제 3: 상품 종합 비교 ⭐ (9개 담보)]      │ ← 기본 활성
│ [예제 4: 보장 여부 확인 (O/X)]              │
└─────────────────────────────────────────────┘
```

**기본 상태**: 예제 3번 (상품 종합 비교)이 자동 로드됨

### 3.2 예제 전환

각 버튼 클릭 시:
- 해당 예제의 JSON fixture 로드
- Response View Model → UI 렌더링
- 이전 응답은 사라지고 새 응답으로 교체

### 3.3 예제별 특징

| 예제 | 파일 | 주요 검증 포인트 |
|---|---|---|
| 예제 1 | `example1_premium.json` | Premium notice 강제 표시, 보험료 경고 UI |
| 예제 2 | `example2_coverage_compare.json` | 5개 조건 테이블, Evidence 클릭 |
| 예제 3 | `example3_product_summary.json` | 9개 담보, 가장 상세한 Notes (7개 항목) |
| 예제 4 | `example4_ox.json` | 단일 회사, O/X 간결한 표시 |

---

## 4. 예제 3번 화면 구조 (최우선 검증)

### 4.1 화면 구성 (Top → Bottom)

```
1. [User Message Bubble]
   "삼성생명과 한화생명 건강보험을 비교해줘"

2. [System Response Card]

   ┌─────────────────────────────────────────┐
   │ 📋 비교 대상 상품                        │
   │ • 삼성생명 건강보험                      │
   │ • 한화생명 건강보험                      │
   └─────────────────────────────────────────┘

   ┌─────────────────────────────────────────┐
   │ 📊 보장 비교표 (9개 담보)                │
   │                                          │
   │ [테이블]                                 │
   │ ┌────────┬──────────┬──────────┐       │
   │ │ 담보   │ 삼성생명 │ 한화생명 │       │
   │ ├────────┼──────────┼──────────┤       │
   │ │ 암     │ 3,000만원│ 5,000만원│       │
   │ │ 진단비 │ 📄 가입p.3│ 📄 가입p.2│     │
   │ ├────────┼──────────┼──────────┤       │
   │ │ ... (9개 행)                  │       │
   │ └────────┴──────────┴──────────┘       │
   └─────────────────────────────────────────┘

   ┌─────────────────────────────────────────┐
   │ 📝 요약                                  │
   │ 두 상품 모두 암, 뇌졸중, 심장질환...     │
   │                                          │
   │ [상세 내용 펼치기 ▼]                     │
   │ (클릭 시 7개 항목 노출)                  │
   └─────────────────────────────────────────┘

   ┌─────────────────────────────────────────┐
   │ ⚠️ 주의사항 펼치기 ▼                     │
   │ (클릭 시 5개 항목 노출)                  │
   └─────────────────────────────────────────┘

   생성 시각: 2025-12-28 10:00:00
```

### 4.2 9개 담보 확인 위치

**위치**: "📊 보장 비교표" 섹션 내부 테이블

**9개 담보 (순서대로)**:
1. 암 진단비
2. 유사암 진단비
3. 뇌출혈 진단비
4. 급성심근경색 진단비
5. 입원일당 (질병)
6. 수술비 (질병)
7. 사망보험금 (질병)
8. 사망보험금 (상해)
9. 후유장해

**각 담보 셀 구조**:
```
┌────────────────────┐
│ 값 (예: 3,000만원) │
│ 📄 출처 (클릭 가능)│
└────────────────────┘
```

### 4.3 Evidence 보기 동작

**트리거**: 📄 아이콘 클릭

**결과**: 모달 팝업

```
┌──────────────────────────────────────┐
│ 📄 암 진단비 - 삼성생명         [X] │
├──────────────────────────────────────┤
│ 값: 3,000만원 (일반암)              │
│                                      │
│ 문서 출처: 가입설계서 p.3, 약관 p.12│
│                                      │
│ [Snippet Placeholder]                │
│ ... 실제 원문 발췌문 ...             │
│                                      │
│ [원문 보기]                          │
└──────────────────────────────────────┘
```

**Note**: Snippet과 "원문 보기"는 현재 placeholder (실제 구현 시 PDF 연결)

### 4.4 Notes 상세 확인

**위치**: "📝 요약" 섹션 → "상세 내용 펼치기 ▼" 클릭

**내용**: 7개 항목
1. 암 진단비 비교
2. 유사암 진단비 비교
3. 뇌출혈/급성심근경색 진단비 비교
4. 입원일당 비교
5. 수술비 비교
6. 사망보험금 비교
7. 후유장해 비교

**확인 방법**: "상세 내용 펼치기" 클릭 → 7개 bullet point 모두 노출

---

## 5. 검증 시나리오 (DoD)

### 5.1 필수 검증 항목

- [ ] **예제 1~4 모두 버튼 클릭으로 전환 가능**
  - 각 버튼 클릭 시 화면 깨짐 없이 렌더링

- [ ] **예제 3에서 9개 담보 모두 표시**
  - 테이블에 9개 행이 모두 노출
  - 각 담보에 회사별 값 + Evidence 표시

- [ ] **Premium notice 강제 표시 (예제 1)**
  - 노란색 배경 경고 배너가 상단에 표시
  - "⚠️ 보험료 안내" 제목 확인

- [ ] **회사명 + 상품명 항상 표시**
  - 모든 예제에서 "📋 비교 대상 상품" 섹션 존재
  - 회사명 + 상품명 함께 표시 (예: "삼성생명 삼성생명 건강보험")

- [ ] **Evidence 클릭 시 모달 동작**
  - 📄 아이콘 클릭 → 모달 팝업
  - 모달에 값, 출처, Snippet 표시
  - [X] 버튼으로 닫기 가능

- [ ] **확인 불가 처리 일관성**
  - Evidence 없는 값은 회색 "확인 불가" 표시
  - Evidence도 "📄 확인 불가" 회색 표시

- [ ] **추천/추론 표현 0건**
  - 화면 전체에서 "추천", "유리", "불리", "더 좋음" 등의 표현 없음
  - Notes에서 사실 비교만 표시

### 5.2 예제별 검증 포인트

#### 예제 1 (보험료)
- Premium notice 배너 표시 확인
- 월 보험료 라벨에 "(참고)" 포함 확인
- Limitations에 보험료 경고 2개 최상단 배치 확인

#### 예제 2 (담보 비교)
- 5개 조건 모두 테이블에 표시
- 두 회사의 값 차이 확인 (예: 삼성 3,000만원 vs 한화 5,000만원)
- Evidence 클릭 시 모달 동작 확인

#### 예제 3 (종합 비교) ⭐
- 9개 담보 테이블 전체 확인
- Notes details 펼치기 → 7개 항목 확인
- 회사명 + 상품명이 테이블 헤더에 표시 확인

#### 예제 4 (O/X)
- 단일 회사 (DB손해보험)만 표시
- Boolean 값이 "✓"로 표시 (true)
- 간결한 2개 조건만 표시

---

## 6. 고객 데모 시나리오

### 6.1 데모 순서 (예제 3 중심)

**시간**: 3~5분

1. **첫 화면 설명** (30초)
   - "할 수 있는 것 / 없는 것" 접기/펼치기
   - 4개 예제 버튼 소개

2. **예제 3번 시연** (2분) ⭐
   - 기본 로드된 상태에서 시작
   - "📊 보장 비교표"에서 9개 담보 스크롤
   - Evidence 클릭 → 모달 팝업 시연
   - "📝 요약" → "상세 내용 펼치기" 클릭 → 7개 항목 확인
   - "⚠️ 주의사항" 펼치기 → 5개 항목 확인

3. **예제 1번 (보험료 경고)** (1분)
   - 예제 1 버튼 클릭
   - 상단 노란색 경고 배너 강조
   - "개인별 보험료 계산 불가" 설명

4. **예제 4번 (O/X)** (30초)
   - 예제 4 버튼 클릭
   - 간결한 O/X 표시 확인
   - "확인 불가" 처리 예시 (없을 경우 언급만)

5. **질의응답** (1분)
   - Evidence 모달에서 "원문 보기" 버튼은 placeholder임을 설명
   - 실제 구현 시 PDF 뷰어로 연결 예정

### 6.2 데모 스크립트 예시

```
"지금 보시는 화면은 STEP NEXT-2/3/4에서 합의한 Response View Model을
실제로 렌더링한 프로토타입입니다.

현재 예제 3번 '상품 종합 비교'가 로드되어 있습니다.
화면을 보시면 삼성생명과 한화생명 두 상품이 비교 대상으로 표시되고,
아래 테이블에는 9개 담보가 나란히 비교되어 있습니다.

각 담보의 📄 아이콘을 클릭하면... [클릭]
이렇게 Evidence 상세 모달이 뜹니다.
값, 문서 출처, 그리고 실제 구현 시에는 원문 발췌가 여기 표시됩니다.

아래로 내려가면 '요약' 섹션이 있고, '상세 내용 펼치기'를 클릭하면...
[클릭] 이렇게 7개 항목의 상세 비교가 나타납니다.

이제 예제 1번 보험료 비교를 볼까요? [클릭]
상단에 노란색 경고 배너가 강제로 표시되며,
'본 시스템은 개인별 보험료 계산 기능을 제공하지 않습니다'라는
안내가 명확히 나타납니다.

이처럼 모든 예제가 합의된 View Model 구조를 정확히 따라
렌더링되는 것을 확인하실 수 있습니다."
```

---

## 7. 기술 세부사항

### 7.1 파일 구조

```
apps/web-prototype/
├── index.html                  (1000+ lines, HTML + CSS + JS)
└── fixtures/
    ├── example1_premium.json           (Premium notice: true)
    ├── example2_coverage_compare.json  (5 dimensions)
    ├── example3_product_summary.json   (9 dimensions)
    └── example4_ox.json                (2 dimensions, single company)
```

### 7.2 핵심 함수

| 함수 | 역할 |
|---|---|
| `loadExample(exampleName)` | Fixture JSON 로드 + 렌더링 트리거 |
| `renderResponse(data)` | View Model → HTML 변환 (메인) |
| `renderQuerySummary(...)` | 비교 대상 상품 렌더링 |
| `renderComparison(...)` | 보장 비교표 렌더링 (테이블) |
| `renderNotes(...)` | 요약 + 상세 내용 렌더링 |
| `renderLimitations(...)` | 주의사항 렌더링 |
| `showEvidence(...)` | Evidence 모달 팝업 |
| `closeEvidenceModal()` | 모달 닫기 |

### 7.3 View Model → UI 매핑

| View Model 필드 | 렌더링 결과 |
|---|---|
| `meta.premium_notice` | 노란색 경고 배너 (조건부) |
| `query_summary.target_products[]` | 리스트 (회사명 + 상품명) |
| `comparison.dimensions[]` | 테이블 행 헤더 |
| `comparison.products[]` | 테이블 컬럼 헤더 |
| `comparison.products[].rows[key].value` | 테이블 셀 값 |
| `comparison.products[].rows[key].evidence` | 📄 아이콘 (클릭 가능) |
| `notes.summary` | 요약 본문 |
| `notes.details[]` | 접기/펼치기 리스트 |
| `limitations[]` | 접기/펼치기 리스트 |

### 7.4 Type별 렌더링 규칙

| type | value | 렌더링 |
|---|---|---|
| `boolean` | `true` | ✓ (녹색) |
| `boolean` | `false` | ✗ (빨간색) |
| `amount` | "3,000만원" | 3,000만원 |
| `text` | "90일" | 90일 |
| `*` | "확인 불가" | 확인 불가 (회색) |
| `*` | `null` | 확인 불가 (회색) |

---

## 8. 제약 사항

### 8.1 현재 프로토타입에서 구현되지 않은 것

- ❌ 실제 LLM 호출
- ❌ 실제 DB 조회
- ❌ Evidence Snippet 실제 데이터 (placeholder)
- ❌ "원문 보기" PDF 뷰어 연결 (버튼만 존재)
- ❌ 자연어 질문 입력 → 응답 생성

### 8.2 의도적으로 제외한 기능

- 추천 알고리즘
- 보험료 계산
- 개인화 로직
- 랭킹/정렬 기능

**이유**: 본 프로토타입은 **렌더링 검증**이 목적이며, 비즈니스 로직은 범위 외

---

## 9. 다음 단계

### 9.1 프로토타입 검증 완료 후

- [ ] 고객 검토 (예제 3번 중심 데모)
- [ ] UI/UX 피드백 수집
- [ ] Response View Model 구조 최종 확정

### 9.2 실제 구현 단계

- [ ] React/Vue/Svelte 등 프레임워크 선택
- [ ] API 연동 (Backend → View Model JSON 반환)
- [ ] Evidence Snippet 실제 데이터 연동
- [ ] PDF 뷰어 구현 ("원문 보기" 기능)

---

## 10. 문제 해결 (Troubleshooting)

### 10.1 Fixture 로딩 실패

**증상**: "예제 로딩 실패: Failed to fetch" 알림

**원인**: 브라우저 CORS 정책

**해결**:
- 옵션 2 (Python 간이 서버) 사용
- 또는 VS Code Live Server 사용

### 10.2 모달이 뜨지 않음

**증상**: Evidence 클릭 시 모달 미표시

**원인**: JavaScript 오류

**해결**:
- 브라우저 개발자 도구 (F12) → Console 확인
- JSON 파싱 오류 여부 확인

### 10.3 스타일이 깨짐

**증상**: 테이블 레이아웃 깨짐

**원인**: 브라우저 호환성

**해결**:
- 최신 Chrome/Firefox/Safari 사용 권장

---

## 11. 참고 문서

- `docs/ui/STEP_NEXT_2_RESPONSE_VIEW_MODEL_AND_UX.md` - View Model 명세
- `docs/ui/STEP_NEXT_3_UI_SKELETON.md` - UI Skeleton 매핑
- `docs/ui/STEP_NEXT_4_UI_MOCK.md` - UI Mock (텍스트 와이어프레임)

---

## 12. 완료 기준 (DoD)

- [x] `index.html` 파일 생성
- [x] Fixture 4개 생성 (example1~4.json)
- [x] 예제 1~4 모두 버튼으로 전환 가능
- [x] 예제 3에서 9개 담보 표시
- [x] Premium notice 조건부 렌더링
- [x] Evidence 모달 동작
- [x] 확인 불가 처리 일관성
- [x] 추천/추론 표현 0건
- [x] 로컬 실행 가능 (No Server Required)

---

**본 프로토타입은 View Model 렌더링 검증 전용이며, 실제 비즈니스 로직 구현은 포함하지 않습니다.**
